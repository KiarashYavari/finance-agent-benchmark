version: "3.9"

services:
  green-agent:
    image: finance-green-agent:latest
    build: .
    container_name: green-agent

    # Expose green agent port
    ports:
      - "9009:9009"

    # Mount models, secrets, and cache directories
    volumes:
      # Read-only models
      - ./tools/models:/app/models:ro
      # Secrets/env (read-only)
      - ./secrets/secrets.env:/app/secrets/secrets.env:ro
      # Writable cache for RAG and SEC downloads
      - ./cache:/app/cache
      # add task data volume
      - ./data:/app/data:ro

    environment:
      # Green agent host and port
      GREEN_AGENT_HOST: "0.0.0.0"
      GREEN_AGENT_PORT: 9009

      # Path to secrets (optional, used inside agent)
      SECRETS_ENV_PATH: "/app/secrets/secrets.env"

      # Optional: dataset if needed by green agent
      DATASET: "/app/data/public.csv"

    restart: unless-stopped
